# BCI-VRvsEEG
Investigating intereference between VR HMD and EEG

***

# Pre-Registration: Electromagnetic Compatibility of Tethered VR and Low-Cost EEG

**Title:** Quantitative Characterization of Electromagnetic Interference in Simultaneous Low-Cost EEG and Tethered VR: A Phantom Head Study using Counterbalanced Repeated Measures.

**Date:** December 14, 2025

**Institution:** Technological University Dublin (TU Dublin)

**Hardware Focus:** OpenBCI Cyton+Daisy (16-Channel) & HTC Vive (Tethered)

---

## 1. Hypotheses
This study aims to quantify the Signal-to-Noise Ratio (SNR) degradation imposed by a tethered Virtual Reality Head-Mounted Display (HMD) on a passive-electrode EEG system.

*   **H1 (Broadband Interference):** The operation of the HMD in any powered state will significantly increase the Root Mean Square (RMS) noise floor compared to the physically unplugged baseline ($RMS_{Active} > RMS_{Baseline}$).
*   **H2 (Current-Dependent EMI):** The spectral power density in the Gamma band (30–80 Hz) will be significantly higher during a full-luminance (White) display state compared to a zero-luminance (Black) state, due to the magnetic flux generated by the HMD’s power management requirements ($Power_{White} > Power_{Black}$).
*   **H3 (Signal Injection/Demodulation):** A visual stimulus flickering at 12 Hz will induce a statistically significant spectral peak at 12 Hz in the phantom data, indicating demodulation or leakage of the video signal into the EEG channels.
*   **H4 (Aliasing Artifacts):** The HMD screen refresh rate (90 Hz) will appear as a distinct spectral peak at 90 Hz in data recorded at 250 Hz (SD Card), but will appear as an **aliased artifact at 35 Hz** in data streamed at 125 Hz (Bluetooth), due to Nyquist folding ($|90 - 125| = 35$).

---

## 2. Design Plan

### 2.1 Study Type
**Experimental, Within-Subjects, Counterbalanced Block Design.**
To control for temporal confounds (e.g., impedance degradation of the phantom, thermal drift of HMD electronics), a **Latin Square** design is employed.

### 2.2 The "Subject" (Phantom)
*   **Object:** *Cucumis melo* (Honeydew/Cantaloupe).
*   **Preparation:** Rind abraded at 10-20 electrode sites; conductive paste applied.
*   **Impedance Criterion:** $< 10 \text{k}\Omega$ across all channels (Verified via OpenBCI GUI prior to recording).
*   **Grounding:** Bias (GND) and Reference (SRB) electrodes connected to the base of the phantom.

### 2.3 Hardware Configuration
*   **EEG:** OpenBCI Cyton + Daisy (16-Channels).
    *   *Path A:* On-board SD Card Logging (Sample Rate: **250 Hz**).
    *   *Path B:* Bluetooth Dongle Streaming (Sample Rate: **125 Hz**).
*   **VR:** HTC Vive (Tethered).
    *   *Tracking:* Lighthouse base stations **ON** and active.
    *   *Proximity Sensor:* Occluded (Taped) to force "Always On" state.

*   **Cable Management:** (Isolation Protocol):
    *   To explicitly differentiate between radiated emissions from the HMD internal electronics (OLED/PMIC) and inductive cross-talk from the tethering cable, a Strict Isolation Topology will be employed.
    *   The VR tether (HDMI/USB/Power) will be routed vertically (superiorly) from the HMD using a suspension support, ensuring a minimum air gap of 10 cm from all EEG electrodes and signal leads. The EEG ribbon cables will be routed inferiorly (down the neck). This "Orthogonal Routing" minimizes inductive coupling, allowing the study to attribute observed interference specifically to near-field emissions from the HMD chassis and display panel.

### 2.4 Independent Variables (Conditions)
1.  **Condition A (Idle):** Solid Black Screen (Electronics On, OLED Off).
2.  **Condition B (Current Stress):** Solid White Screen (Max OLED Current).
3.  **Condition C (Data Stress):** Visual White Noise/Static (Max HDMI Switching).
4.  **Condition D (Injection):** 12 Hz High-Contrast Strobe (Signal Leakage Test).
5.  **Condition E (Soft Standby):** VR Display Off, USB Connected (PC Ground Loop).
6.  **Condition F (Hard Baseline):** HMD Physically Unplugged (True Floating Zero).

---

## 3. Sampling Plan (The Protocol)

The experiment utilizes a **Unity Game Engine** script to automate stimulus presentation, ensuring precise timing and removing researcher latency.

### 3.1 The Automated Sequence (4 Active Runs)
The script executes 4 continuous "Runs" (~18 minutes total). Each Run presents conditions A-D in a counterbalanced order (Latin Square).

*   **Block Duration:** 65 seconds (60s Analysis + 5s Buffer).
*   **Sync Tail:** 10 seconds (5s Strobe + 5s Green Screen) appended to every Run as a spectral timestamp.

**Sequence:**
*   **00:00:** Settling/Sync (Grey). *Manual Tapping Artifact.*
*   **Run 1:** A $\rightarrow$ B $\rightarrow$ D $\rightarrow$ C $\rightarrow$ [Sync Tail]
*   **Run 2:** B $\rightarrow$ C $\rightarrow$ A $\rightarrow$ D $\rightarrow$ [Sync Tail]
*   **Run 3:** C $\rightarrow$ D $\rightarrow$ B $\rightarrow$ A $\rightarrow$ [Sync Tail]
*   **Run 4:** D $\rightarrow$ A $\rightarrow$ C $\rightarrow$ B $\rightarrow$ [Sync Tail]
*   **Manual Phase:**
    *   *Cue:* Screen turns RED.
    *   *Action:* Transition to **Condition E (Standby)** for 2 mins.
    *   *Action:* Transition to **Condition F (Unplugged)** for 5 mins.

### 3.2 Sample Size
Data will be collected from **$N=3$ independent sessions** (new phantom preparation per session) to demonstrate reproducibility.

---

## 4. Analysis Plan

### 4.1 Preprocessing Pipeline
*   **Software:** Python (MNE-Python).
*   **Cropping:** The "Central Window" method will be used. The first 5 seconds and last 5 seconds of every 65-second block are discarded.
*   **Filtering:**
    *   Notch Filter: 50 Hz (Mains).
    *   Bandpass: 1 Hz – 100 Hz.
*   **Referencing:** Common Average Reference (CAR).

### 4.2 Data Aggregation (Drift Correction)
To mitigate impedance drift, data for each condition will be aggregated across the four runs.
$$ \text{Total}_{White} = \text{Run1}_{White} + \text{Run2}_{White} + \text{Run3}_{White} + \text{Run4}_{White} $$

### 4.3 Statistical Inference
Due to the non-biological nature of the data and expected non-normality of EMI bursts:
*   **Primary Test:** **Wilcoxon Signed-Rank Test** (Paired, Non-Parametric).
    *   *Comparison 1:* Condition F (Baseline) vs. Condition B (Idle).
    *   *Comparison 2:* Condition B (Black) vs. Condition C (White).
*   **Significance Level:** $\alpha = 0.05$.

### 4.4 Aliasing Verification
We will perform a Power Spectral Density (PSD) analysis using Welch's Method (Window: 4s, Overlap: 50%) on both the SD Card file and the Bluetooth Stream file.
*   **Criteria for Confirmation:** Identification of a peak at **90 Hz** in the SD file and a corresponding peak at **35 Hz** in the Stream file.

---

## 5. Scripts and Open Science
The Unity automation script (`ExperimentController.cs`) and the Python analysis pipeline (`Analysis_Pipeline.py`) will be made publicly available in the final thesis repository.

---
